<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TorchANI &mdash; TorchANI 2.2.3.dev3+g1c5ee5f documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Train Neural Network Potential From NeuroChem Input File" href="examples/neurochem_trainer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TorchANI
          </a>
              <div class="version">
                2.2.3.dev3+g1c5ee5f
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="start.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">Tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/energy_force.html">Computing Energy and Force Using Models Inside Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/ase_interface.html">Structure minimization and constant temperature MD using ASE interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/jit.html">Using TorchScript to serialize and deploy model</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/vibration_analysis.html">Computing Vibrational Frequencies Using Analytical Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/load_from_neurochem.html">Construct Model From NeuroChem Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/nnp_training.html">Train Your Own Neural Network Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/nnp_training_force.html">Train Neural Network Potential To Both Energies and Forces</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/neurochem_trainer.html">Train Neural Network Potential From NeuroChem Input File</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TorchANI's API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TorchANI</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.models">Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.data">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.utils">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.neurochem">NeuroChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.ase">ASE Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.units">Units</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TorchANI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>TorchANI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="torchani">
<h1>TorchANI<a class="headerlink" href="#torchani" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="torchani.AEVComputer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.</span></code><code class="sig-name descname"><span class="pre">AEVComputer</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">Rcr</span></span></em>, <em><span class="n"><span class="pre">Rca</span></span></em>, <em><span class="n"><span class="pre">EtaR</span></span></em>, <em><span class="n"><span class="pre">ShfR</span></span></em>, <em><span class="n"><span class="pre">EtaA</span></span></em>, <em><span class="n"><span class="pre">Zeta</span></span></em>, <em><span class="n"><span class="pre">ShfA</span></span></em>, <em><span class="n"><span class="pre">ShfZ</span></span></em>, <em><span class="n"><span class="pre">num_species</span></span></em>, <em><span class="n"><span class="pre">use_cuda_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.AEVComputer" title="Permalink to this definition">¶</a></dt>
<dd><p>The AEV computer that takes coordinates as input and outputs aevs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Rcr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(R_C\)</span> in equation (2) when used at equation (3)
in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>Rca</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(R_C\)</span> in equation (2) when used at equation (4)
in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>EtaR</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\eta\)</span> in
equation (3) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfR</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(R_s\)</span> in
equation (3) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>EtaA</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\eta\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>Zeta</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\zeta\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfA</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(R_s\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfZ</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\theta_s\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>num_species</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Number of supported atom types.</li>
<li><strong>use_cuda_extension</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to use cuda extension for faster calculation (needs cuaev installed).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="torchani.AEVComputer.cover_linearly">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><code class="sig-name descname"><span class="pre">cover_linearly</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">radial_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em><span class="n"><span class="pre">angular_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em><span class="n"><span class="pre">radial_eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em><span class="n"><span class="pre">angular_eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em><span class="n"><span class="pre">radial_dist_divisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em><span class="n"><span class="pre">angular_dist_divisions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em><span class="n"><span class="pre">zeta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em><span class="n"><span class="pre">angle_sections</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em><span class="n"><span class="pre">num_species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em><span class="n"><span class="pre">angular_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em><span class="n"><span class="pre">radial_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.cover_linearly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.AEVComputer.cover_linearly" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a convenient way to linearly fill cutoffs</p>
<p>This is a user friendly constructor that builds an
<a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a> where the subdivisions along the the
distance dimension for the angular and radial sub-AEVs, and the angle
sections for the angular sub-AEV, are linearly covered with shifts. By
default the distance shifts start at 0.9 Angstroms.</p>
<p>To reproduce the ANI-1x AEV’s the signature <code class="docutils literal notranslate"><span class="pre">(5.2,</span> <span class="pre">3.5,</span> <span class="pre">16.0,</span> <span class="pre">8.0,</span> <span class="pre">16,</span> <span class="pre">4,</span> <span class="pre">32.0,</span> <span class="pre">8,</span> <span class="pre">4)</span></code>
can be used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchani.AEVComputer.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">input_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">pbc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torchani.aev.SpeciesAEV</span></span></span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.AEVComputer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute AEVs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – <p>Can be one of the following two cases:</p>
<p>If you don’t care about periodic boundary conditions at all,
then input can be a tuple of two tensors: species, coordinates.
species must have shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A)</span></code>, coordinates must have shape
<code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of molecules in a batch,
and <code class="docutils literal notranslate"><span class="pre">A</span></code> is the number of atoms.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The species must be indexed in 0, 1, 2, 3, …, not the element
index in periodic table. Check <a class="reference internal" href="#torchani.SpeciesConverter" title="torchani.SpeciesConverter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.SpeciesConverter</span></code></a>
if you want periodic table indexing.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The coordinates, and cell are in Angstrom.</p>
</div>
<p>If you want to apply periodic boundary conditions, then the input
would be a tuple of two tensors (species, coordinates) and two keyword
arguments <cite>cell=…</cite> , and <cite>pbc=…</cite> where species and coordinates are
the same as described above, cell is a tensor of shape (3, 3) of the
three vectors defining unit cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">z3</span><span class="p">]])</span>
</pre></div>
</div>
<p>and pbc is boolean vector of size 3 storing if pbc is enabled
for that direction.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Species and AEVs. species are the species from the input
unchanged, and AEVs is a tensor of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A,</span> <span class="pre">self.aev_length())</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">NamedTuple</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.ANIModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.</span></code><code class="sig-name descname"><span class="pre">ANIModel</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#ANIModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.ANIModel" title="Permalink to this definition">¶</a></dt>
<dd><p>ANI model that compute energies from species and AEVs.</p>
<p>Different atom types might have different modules, when computing
energies, for each atom, the module for its corresponding atom type will
be applied to its AEV, after that, outputs of modules will be reduced along
different atoms to obtain molecular energies.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The species must be indexed in 0, 1, 2, 3, …, not the element
index in periodic table. Check <a class="reference internal" href="#torchani.SpeciesConverter" title="torchani.SpeciesConverter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.SpeciesConverter</span></code></a>
if you want periodic table indexing.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The resulting energies are in Hartree.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>modules</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Modules for each atom
types. Atom types are distinguished by their order in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">modules</span></code>, which means, for example <code class="docutils literal notranslate"><span class="pre">modules[i]</span></code> must be
the module for atom type <code class="docutils literal notranslate"><span class="pre">i</span></code>. Different atom types can share a
module by putting the same reference in <code class="xref py py-attr docutils literal notranslate"><span class="pre">modules</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.Ensemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.</span></code><code class="sig-name descname"><span class="pre">Ensemble</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">modules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#Ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average output of an ensemble of modules.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.SpeciesConverter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.</span></code><code class="sig-name descname"><span class="pre">SpeciesConverter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#SpeciesConverter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.SpeciesConverter" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts tensors with species labeled as atomic numbers into tensors
labeled with internal torchani indices according to a custom ordering
scheme. It takes a custom species ordering as initialization parameter. If
the class is initialized with [‘H’, ‘C’, ‘N’, ‘O’] for example, it will
convert a tensor [1, 1, 6, 7, 1, 8] into a tensor [0, 0, 1, 2, 0, 3]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<em>sequence of all supported</em>) – </li>
<li><strong>species</strong> – </li>
<li><strong>order</strong> (<em>in order</em><em> (</em><em>it is recommended to</em>) – </li>
<li><strong>number</strong><strong>)</strong><strong>.</strong> (<em>according to atomic</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="torchani.SpeciesConverter.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">input_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">pbc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#SpeciesConverter.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.SpeciesConverter.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert species from periodic table element index to 0, 1, 2, 3, … indexing</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.EnergyShifter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.</span></code><code class="sig-name descname"><span class="pre">EnergyShifter</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">self_energies</span></span></em>, <em><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.EnergyShifter" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for adding and subtracting self atomic energies</p>
<p>This is a subclass of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>, so it can be used directly
in a pipeline as <code class="docutils literal notranslate"><span class="pre">[input-&gt;AEVComputer-&gt;ANIModel-&gt;EnergyShifter-&gt;output]</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>self_energies</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of floating
numbers for the self energy of each atom type. The numbers should
be in order, i.e. <code class="docutils literal notranslate"><span class="pre">self_energies[i]</span></code> should be atom type <code class="docutils literal notranslate"><span class="pre">i</span></code>.</li>
<li><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to calculate the intercept during the LSTSQ
fit. The intercept will also be taken into account to shift energies.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="torchani.EnergyShifter.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species_energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">pbc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torchani.nn.SpeciesEnergies</span></span></span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.EnergyShifter.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>(species, molecular energies)-&gt;(species, molecular energies + sae)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchani.EnergyShifter.sae">
<code class="sig-name descname"><span class="pre">sae</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter.sae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.EnergyShifter.sae" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute self energies for molecules.</p>
<p>Padding atoms will be automatically excluded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Long tensor in shape
<code class="docutils literal notranslate"><span class="pre">(conformations,</span> <span class="pre">atoms)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">1D vector in shape <code class="docutils literal notranslate"><span class="pre">(conformations,)</span></code>
for molecular self energies.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.nn.Gaussian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.nn.</span></code><code class="sig-name descname"><span class="pre">Gaussian</span></code><a class="reference internal" href="_modules/torchani/nn.html#Gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.nn.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian activation</p>
</dd></dl>

</div>
<div class="section" id="module-torchani.models">
<span id="model-zoo"></span><h1>Model Zoo<a class="headerlink" href="#module-torchani.models" title="Permalink to this headline">¶</a></h1>
<p>The ANI model zoo that stores public ANI models.</p>
<p>Currently the model zoo has three models: ANI-1x, ANI-1ccx, and ANI-2x.
The parameters of these models are stored in <a class="reference external" href="https://github.com/aiqm/ani-model-zoo">ani-model-zoo</a> repository and
will be automatically downloaded the first time any of these models are
instantiated. The classes of these models are <a class="reference internal" href="#torchani.models.ANI1x" title="torchani.models.ANI1x"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANI1x</span></code></a>, <a class="reference internal" href="#torchani.models.ANI1ccx" title="torchani.models.ANI1ccx"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANI1ccx</span></code></a>,
and <a class="reference internal" href="#torchani.models.ANI2x" title="torchani.models.ANI2x"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANI2x</span></code></a> these are subclasses of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>.
To use the models just instantiate them and either
directly calculate energies or get an ASE calculator. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ani1x</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">ANI1x</span><span class="p">()</span>
<span class="c1"># compute energy using ANI-1x model ensemble</span>
<span class="n">_</span><span class="p">,</span> <span class="n">energies</span> <span class="o">=</span> <span class="n">ani1x</span><span class="p">((</span><span class="n">species</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">))</span>
<span class="n">ani1x</span><span class="o">.</span><span class="n">ase</span><span class="p">()</span>  <span class="c1"># get ASE Calculator using this ensemble</span>
<span class="c1"># convert atom species from string to long tensor</span>
<span class="n">ani1x</span><span class="o">.</span><span class="n">species_to_tensor</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>

<span class="n">model0</span> <span class="o">=</span> <span class="n">ani1x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># get the first model in the ensemble</span>
<span class="c1"># compute energy using the first model in the ANI-1x model ensemble</span>
<span class="n">_</span><span class="p">,</span> <span class="n">energies</span> <span class="o">=</span> <span class="n">model0</span><span class="p">((</span><span class="n">species</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">))</span>
<span class="n">model0</span><span class="o">.</span><span class="n">ase</span><span class="p">()</span>  <span class="c1"># get ASE Calculator using this model</span>
<span class="c1"># convert atom species from string to long tensor</span>
<span class="n">model0</span><span class="o">.</span><span class="n">species_to_tensor</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="torchani.models.ANI1x">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.models.</span></code><code class="sig-name descname"><span class="pre">ANI1x</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">periodic_table_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em><span class="n"><span class="pre">model_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/models.html#ANI1x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.models.ANI1x" title="Permalink to this definition">¶</a></dt>
<dd><p>The ANI-1x model as in <a class="reference external" href="https://github.com/isayev/ASE_ANI/tree/master/ani_models/ani-1x_8x">ani-1x_8x on GitHub</a> and <a class="reference external" href="https://aip.scitation.org/doi/abs/10.1063/1.5023802">Active Learning Paper</a>.</p>
<p>The ANI-1x model is an ensemble of 8 networks that was trained using
active learning on the ANI-1x dataset, the target level of theory is
wB97X/6-31G(d). It predicts energies on HCNO elements exclusively, it
shouldn’t be used with other atom types.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.models.ANI1ccx">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.models.</span></code><code class="sig-name descname"><span class="pre">ANI1ccx</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">periodic_table_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em><span class="n"><span class="pre">model_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/models.html#ANI1ccx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.models.ANI1ccx" title="Permalink to this definition">¶</a></dt>
<dd><p>The ANI-1ccx model as in <a class="reference external" href="https://github.com/isayev/ASE_ANI/tree/master/ani_models/ani-1ccx_8x">ani-1ccx_8x on GitHub</a> and <a class="reference external" href="https://doi.org/10.26434/chemrxiv.6744440.v1">Transfer Learning Paper</a>.</p>
<p>The ANI-1ccx model is an ensemble of 8 networks that was trained
on the ANI-1ccx dataset, using transfer learning. The target accuracy
is CCSD(T)*/CBS (CCSD(T) using the DPLNO-CCSD(T) method). It predicts
energies on HCNO elements exclusively, it shouldn’t be used with other
atom types.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.models.ANI2x">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.models.</span></code><code class="sig-name descname"><span class="pre">ANI2x</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">periodic_table_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em><span class="n"><span class="pre">model_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/models.html#ANI2x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.models.ANI2x" title="Permalink to this definition">¶</a></dt>
<dd><p>The ANI-2x model as in <a class="reference external" href="https://doi.org/10.26434/chemrxiv.11819268.v1">ANI2x Paper</a> and <a class="reference external" href="https://github.com/cdever01/ani-2x_results">ANI2x Results on GitHub</a>.</p>
<p>The ANI-2x model is an ensemble of 8 networks that was trained on the
ANI-2x dataset. The target level of theory is wB97X/6-31G(d). It predicts
energies on HCNOFSCl elements exclusively it shouldn’t be used with other
atom types.</p>
</dd></dl>

</div>
<div class="section" id="module-torchani.data">
<span id="datasets"></span><h1>Datasets<a class="headerlink" href="#module-torchani.data" title="Permalink to this headline">¶</a></h1>
<p>Tools for loading, shuffling, and batching ANI datasets</p>
<p>The <cite>torchani.data.load(path)</cite> creates an iterable of raw data,
where species are strings, and coordinates are numpy ndarrays.</p>
<p>You can transform this iterable by using transformations.
To do a transformation, call <cite>it.transformation_name()</cite>. This
will return an iterable that may be cached depending on the specific
transformation.</p>
<p>Available transformations are listed below:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>species_to_indices</cite> accepts two different kinds of arguments. It converts</dt><dd>species from elements (e. g. “H”, “C”, “Cl”, etc) into internal torchani
indices (as returned by <a class="reference internal" href="#torchani.utils.ChemicalSymbolsToInts" title="torchani.utils.ChemicalSymbolsToInts"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.utils.ChemicalSymbolsToInts</span></code></a> or
the <code class="docutils literal notranslate"><span class="pre">species_to_tensor</span></code> method of a <code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.models.BuiltinModel</span></code>
and <a class="reference internal" href="#torchani.neurochem.Constants" title="torchani.neurochem.Constants"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.neurochem.Constants</span></code></a>), if its argument is an iterable
of species. By default species_to_indices behaves this way, with an
argument of <code class="docutils literal notranslate"><span class="pre">('H',</span> <span class="pre">'C',</span> <span class="pre">'N',</span> <span class="pre">'O',</span> <span class="pre">'F',</span> <span class="pre">'S',</span> <span class="pre">'Cl')</span></code>  However, if its
argument is the string “periodic_table”, then elements are converted into
atomic numbers (“periodic table indices”) instead. This last option is
meant to be used when training networks that already perform a forward pass
of <a class="reference internal" href="#torchani.SpeciesConverter" title="torchani.nn.SpeciesConverter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.nn.SpeciesConverter</span></code></a> on their inputs in order to
convert elements to internal indices, before processing the coordinates.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>subtract_self_energies</cite> subtracts self energies from all molecules of the</dt><dd>dataset. It accepts two different kinds of arguments: You can pass a dict
of self energies, in which case self energies are directly subtracted
according to the key-value pairs, or a
<a class="reference internal" href="#torchani.EnergyShifter" title="torchani.utils.EnergyShifter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.utils.EnergyShifter</span></code></a>, in which case the self energies are
calculated by linear regression and stored inside the class in the order
specified by species_order. By default the function orders by atomic
number if no extra argument is provided, but a specific order may be requested.</dd>
</dl>
</li>
<li><cite>remove_outliers</cite> removes some outlier energies from the dataset if present.</li>
<li><dl class="first docutils">
<dt><cite>shuffle</cite> shuffles the provided dataset. Note that if the dataset is</dt><dd>not cached (i.e. it lives in the disk and not in memory) then this method
will cache it before shuffling. This may take time and memory depending on
the dataset size. This method may be used before splitting into validation/training
shuffle all molecules in the dataset, and ensure a uniform sampling from
the initial dataset, and it can also be used during training on a cached
dataset of batches to shuffle the batches.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>cache</cite> cache the result of previous transformations.</dt><dd>If the input is already cached this does nothing.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>collate</cite> creates batches and pads the atoms of all molecules in each batch</dt><dd>with dummy atoms, then converts each batch to tensor. <cite>collate</cite> uses a
default padding dictionary:
<code class="docutils literal notranslate"><span class="pre">{'species':</span> <span class="pre">-1,</span> <span class="pre">'coordinates':</span> <span class="pre">0.0,</span> <span class="pre">'forces':</span> <span class="pre">0.0,</span> <span class="pre">'energies':</span> <span class="pre">0.0}</span></code> for
padding, but a custom padding dictionary can be passed as an optional
parameter, which overrides this default padding. Note that this function
returns a generator, it doesn’t cache the result in memory.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>pin_memory</cite> copies the tensor to pinned (page-locked) memory so that later transfer</dt><dd>to cuda devices can be done faster.</dd>
</dl>
</li>
</ul>
<p>you can also use <cite>split</cite> to split the iterable to pieces. use <cite>split</cite> as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">it</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ratio1</span><span class="p">,</span> <span class="n">ratio2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>where None in the end indicate that we want to use all of the rest.</p>
<p>Note that orderings used in <a class="reference internal" href="#torchani.utils.ChemicalSymbolsToInts" title="torchani.utils.ChemicalSymbolsToInts"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.utils.ChemicalSymbolsToInts</span></code></a> and
<a class="reference internal" href="#torchani.SpeciesConverter" title="torchani.nn.SpeciesConverter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.nn.SpeciesConverter</span></code></a> should be consistent with orderings used
in <cite>species_to_indices</cite> and <cite>subtract_self_energies</cite>. To prevent confusion it
is recommended that arguments to intialize converters and arguments to these
functions all order elements <em>by their atomic number</em> (e. g. if you are working
with hydrogen, nitrogen and bromine always use [‘H’, ‘N’, ‘Br’] and never [‘N’,
‘H’, ‘Br’] or other variations). It is possible to specify a different custom
ordering, mainly due to backwards compatibility and to fully custom atom types,
but doing so is NOT recommended, since it is very error prone.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy_shifter</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">EnergyShifter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">training</span><span class="p">,</span> <span class="n">validation</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dspath</span><span class="p">)</span><span class="o">.</span><span class="n">subtract_self_energies</span><span class="p">(</span><span class="n">energy_shifter</span><span class="p">)</span><span class="o">.</span><span class="n">species_to_indices</span><span class="p">()</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="n">size</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">training</span> <span class="o">=</span> <span class="n">training</span><span class="o">.</span><span class="n">collate</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
<span class="n">validation</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">collate</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span><span class="p">()</span>
</pre></div>
</div>
<p>If the above approach takes too much memory for you, you can then use dataloader
with multiprocessing to achieve comparable performance with less memory usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">training</span><span class="p">,</span> <span class="n">validation</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dspath</span><span class="p">)</span><span class="o">.</span><span class="n">subtract_self_energies</span><span class="p">(</span><span class="n">energy_shifter</span><span class="p">)</span><span class="o">.</span><span class="n">species_to_indices</span><span class="p">()</span><span class="o">.</span><span class="n">shuffle</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">training</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">training</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="n">torchani</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">validation</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">validation</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="n">torchani</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-torchani.utils">
<span id="utilities"></span><h1>Utilities<a class="headerlink" href="#module-torchani.utils" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.pad_atomic_properties">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">pad_atomic_properties</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">properties</span></span></em>, <em><span class="n"><span class="pre">padding_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'species':</span> <span class="pre">-</span> <span class="pre">1}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#pad_atomic_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.pad_atomic_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Put a sequence of atomic properties together into single tensor.</p>
<p>Inputs are <cite>[{‘species’: …, …}, {‘species’: …, …}, …]</cite> and the outputs
are <cite>{‘species’: padded_tensor, …}</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – sequence of properties.</li>
<li><strong>padding_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – the value to fill to pad tensors to same size</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.present_species">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">present_species</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#present_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.present_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a vector of species of atoms, compute the unique species present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – 1D vector of shape <code class="docutils literal notranslate"><span class="pre">(atoms,)</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">1D vector storing present atom types sorted.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.strip_redundant_padding">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">strip_redundant_padding</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">atomic_properties</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#strip_redundant_padding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.strip_redundant_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip trailing padding atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atomic_properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – properties to strip</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">same set of properties with redundant padding atoms stripped.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.map2central">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">map2central</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">cell</span></span></em>, <em><span class="n"><span class="pre">coordinates</span></span></em>, <em><span class="n"><span class="pre">pbc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#map2central"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.map2central" title="Permalink to this definition">¶</a></dt>
<dd><p>Map atoms outside the unit cell into the cell using PBC.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cell</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – <p>tensor of shape (3, 3) of the three
vectors defining unit cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([[</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">],</span>
        <span class="p">[</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">z3</span><span class="p">]])</span>
</pre></div>
</div>
</li>
<li><strong>coordinates</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Tensor of shape
<code class="docutils literal notranslate"><span class="pre">(molecules,</span> <span class="pre">atoms,</span> <span class="pre">3)</span></code>.</li>
<li><strong>pbc</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – boolean vector of size 3 storing
if pbc is enabled for that direction.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">coordinates of atoms mapped back to unit cell.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.utils.ChemicalSymbolsToInts">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">ChemicalSymbolsToInts</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">all_species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#ChemicalSymbolsToInts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.ChemicalSymbolsToInts" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper that can be called to convert chemical symbol string to integers
On initialization the class should be supplied with a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> (or in
general <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>. The returned
instance is a callable object, which can be called with an arbitrary list
of the supported species that is converted into a tensor of dtype
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.long</span></code>. Usage example:
.. code-block:: python</p>
<blockquote>
<div>from torchani.utils import ChemicalSymbolsToInts
# We initialize ChemicalSymbolsToInts with the supported species
species_to_tensor = ChemicalSymbolsToInts([‘H’, ‘C’, ‘Fe’, ‘Cl’])
# We have a species list which we want to convert to an index tensor
index_tensor = species_to_tensor([‘H’, ‘C’, ‘H’, ‘H’, ‘C’, ‘Cl’, ‘Fe’])
# index_tensor is now [0 1 0 0 1 3 2]</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the input is a string python will iterate over
characters, this means that a string such as ‘CHClFe’ will be
intepreted as ‘C’ ‘H’ ‘C’ ‘l’ ‘F’ ‘e’. It is recommended that you
input either a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [‘C’, ‘H’, ‘Cl’, ‘Fe’],
and not a string. The output of a call does NOT correspond to a
tensor of atomic numbers.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>all_species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – </li>
<li><strong>species</strong> (<em>sequence of all supported</em>) – </li>
<li><strong>order</strong> (<em>in order</em><em> (</em><em>it is recommended to</em>) – </li>
<li><strong>number</strong><strong>)</strong><strong>.</strong> (<em>according to atomic</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="torchani.utils.ChemicalSymbolsToInts.forward">
<code class="sig-name descname"><span class="pre">forward</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a></span></span><a class="reference internal" href="_modules/torchani/utils.html#ChemicalSymbolsToInts.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.ChemicalSymbolsToInts.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert species from sequence of strings to 1D tensor</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.hessian">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">hessian</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a></span></em>, <em><span class="n"><span class="pre">energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">forces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><span class="pre">torch.Tensor</span></a></span></span><a class="reference internal" href="_modules/torchani/utils.html#hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute analytical hessian from the energy graph or force graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coordinates</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Tensor of shape <cite>(molecules, atoms, 3)</cite></li>
<li><strong>energies</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Tensor of shape <cite>(molecules,)</cite>, if specified,
then <cite>forces</cite> must be <cite>None</cite>. This energies must be computed from
<cite>coordinates</cite> in a graph.</li>
<li><strong>forces</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Tensor of shape <cite>(molecules, atoms, 3)</cite>, if specified,
then <cite>energies</cite> must be <cite>None</cite>. This forces must be computed from
<cite>coordinates</cite> in a graph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Tensor of shape <cite>(molecules, 3A, 3A)</cite> where A is the number of
atoms in each molecule</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.vibrational_analysis">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">vibrational_analysis</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">masses</span></span></em>, <em><span class="n"><span class="pre">hessian</span></span></em>, <em><span class="n"><span class="pre">mode_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MDU'</span></span></em>, <em><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cm^-1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#vibrational_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.vibrational_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Computing the vibrational wavenumbers from hessian.</p>
<p>Note that normal modes in many popular software packages such as
Gaussian and ORCA are output as mass deweighted normalized (MDN).
Normal modes in ASE are output as mass deweighted unnormalized (MDU).
Some packages such as Psi4 let ychoose different normalizations.
Force constants and reduced masses are calculated as in Gaussian.</p>
<p>mode_type should be one of:
- MWN (mass weighted normalized)
- MDU (mass deweighted unnormalized)
- MDN (mass deweighted normalized)</p>
<p>MDU modes are not orthogonal, and not normalized,
MDN modes are not orthogonal, and normalized.
MWN modes are orthonormal, but they correspond
to mass weighted cartesian coordinates (x’ = sqrt(m)x).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.utils.get_atomic_masses">
<code class="sig-prename descclassname"><span class="pre">torchani.utils.</span></code><code class="sig-name descname"><span class="pre">get_atomic_masses</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#get_atomic_masses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.utils.get_atomic_masses" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a tensor of atomic numbers (“periodic table indices”) into a tensor of atomic masses</p>
<p>Atomic masses supported are the first 119 elements, and are taken from:</p>
<p>Atomic weights of the elements 2013 (IUPAC Technical Report). Meija, J.,
Coplen, T., Berglund, M., et al. (2016). Pure and Applied Chemistry, 88(3), pp.
265-291. Retrieved 30 Nov. 2016, from doi:10.1515/pac-2015-0305</p>
<p>They are all consistent with those used in ASE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – tensor with atomic numbers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Tensor of dtype <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.double</span></code>, with
atomic masses, with the same shape as the input.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-torchani.neurochem">
<span id="neurochem"></span><h1>NeuroChem<a class="headerlink" href="#module-torchani.neurochem" title="Permalink to this headline">¶</a></h1>
<p>Tools for loading/running NeuroChem input files.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torchani.neurochem.Constants">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">Constants</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Constants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.Constants" title="Permalink to this definition">¶</a></dt>
<dd><p>NeuroChem constants. Objects of this class can be used as arguments
to <a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a>, like <code class="docutils literal notranslate"><span class="pre">torchani.AEVComputer(**consts)</span></code>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchani.neurochem.Constants.species_to_tensor">
<code class="sig-name descname"><span class="pre">species_to_tensor</span></code><a class="headerlink" href="#torchani.neurochem.Constants.species_to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>call to convert
string chemical symbols to 1d long tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChemicalSymbolsToInts</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.neurochem.load_sae">
<code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">load_sae</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">filename</span></span></em>, <em><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_sae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.load_sae" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an object of <code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyShifter</span></code> with self energies from
NeuroChem sae file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.neurochem.load_atomic_network">
<code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">load_atomic_network</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_atomic_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.load_atomic_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Sequential.html#torch.nn.Sequential" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code></a> with hyperparameters
and parameters loaded NeuroChem’s .nnf, .wparam and .bparam files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.neurochem.load_model">
<code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">load_model</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em>, <em><span class="n"><span class="pre">dir_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference internal" href="#torchani.ANIModel" title="torchani.ANIModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.ANIModel</span></code></a> loaded from
NeuroChem’s network directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of strings for
chemical symbols of each supported atom type in correct order.</li>
<li><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – String for directory storing network configurations.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.neurochem.load_model_ensemble">
<code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">load_model_ensemble</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em>, <em><span class="n"><span class="pre">prefix</span></span></em>, <em><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_model_ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.load_model_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference internal" href="#torchani.Ensemble" title="torchani.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.Ensemble</span></code></a> loaded from
NeuroChem’s network directories beginning with the given prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of strings for
chemical symbols of each supported atom type in correct order.</li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Prefix of paths of directory that networks configurations
are stored.</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Number of models in the ensemble.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchani.neurochem.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.neurochem.</span></code><code class="sig-name descname"><span class="pre">Trainer</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">filename</span></span></em>, <em><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em><span class="n"><span class="pre">tqdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em><span class="n"><span class="pre">tensorboard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">checkpoint_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model.pt'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Train with NeuroChem training configurations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Input file name</li>
<li><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensor_attributes.html#torch.device" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code></a>) – device to train the model</li>
<li><strong>tqdm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – whether to enable tqdm</li>
<li><strong>tensorboard</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Directory to store tensorboard log file, set to
<code class="docutils literal notranslate"><span class="pre">None</span></code> to disable tensorboard.</li>
<li><strong>checkpoint_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the checkpoint file, checkpoints
will be stored in the network directory with this file name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="torchani.neurochem.Trainer.evaluate">
<code class="sig-name descname"><span class="pre">evaluate</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.Trainer.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the evaluation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchani.neurochem.Trainer.load_data">
<code class="sig-name descname"><span class="pre">load_data</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">training_path</span></span></em>, <em><span class="n"><span class="pre">validation_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.Trainer.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load training and validation dataset from file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchani.neurochem.Trainer.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.neurochem.Trainer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the training</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-torchani.neurochem.trainer"></span><p>Besides running NeuroChem trainer by programming, we can also run it by
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">torchani.neurochem.trainer</span></code>, use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> option for help.</p>
</div>
<div class="section" id="module-torchani.ase">
<span id="ase-interface"></span><h1>ASE Interface<a class="headerlink" href="#module-torchani.ase" title="Permalink to this headline">¶</a></h1>
<p>Tools for interfacing with <a class="reference external" href="https://wiki.fysik.dtu.dk/ase">ASE</a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torchani.ase.Calculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><code class="sig-prename descclassname"><span class="pre">torchani.ase.</span></code><code class="sig-name descname"><span class="pre">Calculator</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">species</span></span></em>, <em><span class="n"><span class="pre">model</span></span></em>, <em><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ase.html#Calculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.ase.Calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>TorchANI calculator for ASE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – sequence of all supported species, in order.</li>
<li><strong>model</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v1.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>) – neural network potential model
that convert coordinates into energies.</li>
<li><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – After wrapping atoms into central box, whether
to replace the original positions stored in <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.Atoms" title="(in ASE)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code></a>
object with the wrapped positions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-torchani.units">
<span id="units"></span><h1>Units<a class="headerlink" href="#module-torchani.units" title="Permalink to this headline">¶</a></h1>
<p>Unit conversion factors used in torchani</p>
<p>The torchani networks themselves works internally entirely in Hartrees
(energy), Angstroms (distance) and AMU (mass). In some example code and scripts
we convert to other more commonly used units. Our conversion factors are
consistent with <a class="reference external" href="https://arxiv.org/pdf/1507.07956.pdf">CODATA 2014 recommendations</a>, which is also consistent with
the <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/units.html#units">units used in ASE</a>. (However, take into account that ASE uses
electronvolt as its base energy unit, so the appropriate conversion factors
should always be applied when converting from ASE to torchani) Joule-to-kcal
conversion taken from the <a class="reference external" href="https://goldbook.iupac.org/terms/view/C00784">IUPAC Goldbook</a>.  All the conversion factors we use
are defined in this module, and convenience functions to convert between
different units are provided.</p>
<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.hartree2ev">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">hartree2ev</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#hartree2ev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.hartree2ev" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree to eV conversion factor from 2014 CODATA</p>
<p>1 Hartree = 27.211386024367243 eV</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.hartree2kcalmol">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">hartree2kcalmol</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#hartree2kcalmol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.hartree2kcalmol" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree to kJ/mol conversion factor from CODATA 2014</p>
<p>1 Hartree = 627.5094738898777 kcal/mol</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.hartree2kjoulemol">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">hartree2kjoulemol</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#hartree2kjoulemol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.hartree2kjoulemol" title="Permalink to this definition">¶</a></dt>
<dd><p>&lt;function hartree2kjoulemol at 0x7f000ff24310&gt;</p>
<p>1 Hartree = 2625.4996387552483 kJ/mol</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.ev2kcalmol">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">ev2kcalmol</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#ev2kcalmol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.ev2kcalmol" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronvolt to kcal/mol conversion factor from CODATA 2014</p>
<p>1 eV = 23.060548012069496 kcal/mol</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.ev2kjoulemol">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">ev2kjoulemol</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#ev2kjoulemol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.ev2kjoulemol" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronvolt to kJ/mol conversion factor from CODATA 2014</p>
<p>1 eV = 96.48533288249877 kJ/mol</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.mhessian2fconst">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">mhessian2fconst</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#mhessian2fconst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.mhessian2fconst" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts mass-scaled hessian units into mDyne/Angstrom</p>
<blockquote>
<div>Converts from units of mass-scaled hessian (Hartree / (amu * Angstrom^2)
into force constant units (mDyne/Angstom), where 1 N = 1 * 10^8 mDyne</div></blockquote>
<p>1 Hartree / (AMU * Angstrom^2) = 23.060548012069496 mDyne/Angstrom</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.sqrt_mhessian2invcm">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">sqrt_mhessian2invcm</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#sqrt_mhessian2invcm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.sqrt_mhessian2invcm" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts sqrt(mass-scaled hessian units) into cm^-1</p>
<blockquote>
<div><p>Converts form units of sqrt(Hartree / (amu * Angstrom^2))
which are sqrt(units of the mass-scaled hessian matrix)
into units of inverse centimeters.</p>
<p>Take into account that to convert the actual eigenvalues of the hessian
into wavenumbers it is necessary to multiply by an extra factor of 1 / (2 *
pi)</p>
</div></blockquote>
<p>1 sqrt(Hartree / (AMU * Angstrom^2)) = 17091.7006789297 cm^-1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchani.units.sqrt_mhessian2milliev">
<code class="sig-prename descclassname"><span class="pre">torchani.units.</span></code><code class="sig-name descname"><span class="pre">sqrt_mhessian2milliev</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/units.html#sqrt_mhessian2milliev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchani.units.sqrt_mhessian2milliev" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts sqrt(mass-scaled hessian units) into meV</p>
<blockquote>
<div><p>Converts form units of sqrt(Hartree / (amu * Angstrom^2))
which are sqrt(units of the mass-scaled hessian matrix)
into units of milli-electronvolts.</p>
<p>Take into account that to convert the actual eigenvalues of the hessian
into wavenumbers it is necessary to multiply by an extra factor of 1 / (2 *
pi)</p>
</div></blockquote>
<p>1 sqrt(Hartree / (AMU * Angstrom^2)) = 2119.1007908167267 meV</p>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/neurochem_trainer.html" class="btn btn-neutral float-left" title="Train Neural Network Potential From NeuroChem Input File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Roitberg Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>